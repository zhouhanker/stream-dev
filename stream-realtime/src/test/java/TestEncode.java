import com.zh.DataSecureUtils;

import javax.crypto.SecretKey;
import javax.crypto.spec.SecretKeySpec;

/**
 * @Package PACKAGE_NAME.TestEncode
 * @Author zhou.han
 * @Date 2025/8/3 01:16
 * @description:
 */
public class TestEncode {
    public static void main(String[] args) {
        String str = "{\"UPEXGMSGREALLOCATION\":{\"dateTime\":\"20250730121804\",\"altitude\":48,\"vec3\":23902,\"alarm\":{\"terminalLcdError\":0,\"earlyWarning\":0,\"terminalMainPowerUnderVoltage\":0,\"inOutRoute\":0,\"oilError\":0,\"overSpeed\":0,\"emergencyAlarm\":0,\"rolloverWarning\":0,\"illegalMove\":0,\"inOutArea\":0,\"gnssAntennaDisconnect\":0,\"laneDepartureError\":0,\"stopTimeout\":0,\"vssError\":0,\"ttsModuleError\":0,\"fatigueDriving\":0,\"gnssAntennaShortCircuit\":0,\"collisionRollover\":0,\"overspeedWarning\":0,\"cameraError\":0,\"illegalIgnition\":0,\"roadDrivingTimeout\":0,\"icModuleError\":0,\"banOnDrivingWarning\":0,\"stolen\":0,\"gnssModuleError\":0,\"cumulativeDrivingTimeout\":0,\"terminalMainPowerFailure\":0,\"driverFatigueMonitor\":0},\"msgId\":4610,\"encrypy\":0,\"vec2\":36,\"lon\":114.179001,\"vec1\":36,\"state\":{\"acc\":0,\"loadRating\":1,\"door\":0,\"laneDepartureWarning\":0,\"latLonEncryption\":0,\"electricCircuit\":0,\"location\":0,\"lon\":0,\"forwardCollisionWarning\":0,\"operation\":0,\"lat\":0,\"oilPath\":0},\"lat\":22.708228,\"direction\":343},\"DATATYPE\":4610,\"DATA\":\"AB4HB+kMEgQGzju5AVqABAAkACQAAF1eAVcAMABAAAMAAAAA\",\"UPEXGMSGREGISTER\":null,\"VEHICLENO\":\"粤BEJ546\",\"DATALEN\":36,\"VEHICLECOLOR\":2}";
        SecretKey secretKey = new SecretKeySpec(DataSecureUtils.keyBytes, "AES");
        System.out.println("使用的固定密钥: " + DataSecureUtils.bytesToHex(secretKey.getEncoded()));

        DataSecureUtils crypto = new DataSecureUtils(secretKey);
//        byte[] encrypted = crypto.encrypt(str);
//        System.out.println("\n加密结果 (IV+密文+标签):");
//        System.out.println("长度: " + encrypted.length + " 字节");
//        System.out.println("Hex: " + DataSecureUtils.bytesToHex(encrypted));
        byte[] sss = DataSecureUtils.hexStringToByteArray("EA23AC19DD582E567787DB0480A9518499D9357FF44850202E3C231A691F79364A839938CE9CA5DF2C0414D4003B266967B63AB12D049F9E9E8111F780A41E3548B9C87C54FE29A975C5B5057CC55A2FCDCD902F2563235CA1A394356F09BF43B183A514D7DB18E6FC3F669A18A7B044D8A0F88D211A885552011036D19940CDF38AD7A761548F0C8CC5ECAF057C43E997E32839B20E636880A34C0CB809556797F05E2C32AF4C2CB43E104072052966550C5B7E1F57F70888F76D9B35D84AF4F3C997484A5A194F4BA091F6750192DF2A7B73456C213B60704B1737971705FD0CC2F0081ED2E38D49CBEE9974933494421FBFE6B806754914CC24B53FFE09D0031A7221885A6928A5F8C7A8EE5EA6E8CCA4EC3DD48B8AE8E2E016B3E15471848B89C8DC2D34AE3FFBBFD2B7AA718DAA8FD8C0F58EBAF6B2D051855D8BBF3265A60472F67262EF3DDC5FB879C3C0BA725AA0563A51457F9349FAD61E95E6117AA542D5081DA9AA530A1724D3D60F2DB9FB366E0DABE2B0FE6826072D1318D2D19C83F6C8EDC772D5679E50EBAA23F10EDA5F118F1670733FE013082894CBABB0AFDF86013DB77256FB579DB8D41F7C0077A36FF702401A1D213CC4093894197BB504A831FF42ADA5AE88D90B18AC22AF34CACE2939B9E2B64A7AFC19374E8EE74AE19BEE4B0E1B1C33109B73AE57DCF2EFB342C49BD20B2EDC865EE350B0EECFB54D64A71B9BBF4B61769C8EC158A045E07147092E81BB9A48015BAD455EAAAD41AC81E2582C7F8E4631BBC7AC4431613082F51EC51DACA0D0680E0E3F248A60987930C9AF08E7C8402566DFEBAA22F573CFED0FDDB4509FD24C37DE0E3EFA0E2780C959017E0CDC417F93D2977CBA1CD9C283660933EA72FDB53AE0167BCBD8CBB8845DF1066B1B1BDF6149DDF6A4EBBB100FF3DB1BCFB4EEA0BF8AE787A3C7096DBE3A98D33E531FADE510FECA3FF4D10C3DF205A6AA65E9419B1EC54F0F6C89C71B0BAA3BF18DDAB288BFDAFBB3EA3EB015F53D3EC418E16485BC5F302E03BA8F4DEE3B8F379906771F10DF7366D979D9DBABF88875C7448E30D92CA07B2A26165AC84B58D6F399CB04621DEB5FB9092856C224284415428F1EB34204B5E0954000821740693FB6854667771CD08524EC0CA09B03E8C01892DE98B5177A65A0FCE55DCC4A7F30484FD747821F67AE7237826FE92DAA0289B941F4908E5F68F416E6D975190365600925556CDEE1482986A032B426F0CFE1979C7357EDFF1FDDA4187EAA462260CAB292F095F07BCD188D9F4CFE6EB0822BE776B9DA6E1707D86C33681D4CEC6910DC6029648208C1149FFA56992840F70AAB1A7A8390C921B7CD81BC03D0103D76768EE8CE9B2B05CCB6D50632511614E825458A32F59C249E2890A3FF1DEB5E01CA25F9E33156B7EE2C23AF806110E2D89C60B6918CF8E22F43644FE43D153969853ED1291F0A357B7D9C692DBC7E930F92D65139B992690A8D672D720685B62CA68B78A33350A99F9BEF561EDA368E6CFB3419CCBED418F7F381D2DFCEF431CD5E5BCF2C92697B5A7507CEB70DE51B56810BDBCBB1D6DDF7A1BB5D88EA2C9515A31DC41FCA10384ADB8786C2");

        String decrypted = crypto.decrypt(sss);
        System.err.println(decrypted);
    }
}
